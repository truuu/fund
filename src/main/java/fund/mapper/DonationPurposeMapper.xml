<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="fund.mapper.DonationPurposeMapper">

<select id="selectAll" resultType="fund.dto.DonationPurpose">
SELECT d.*, c1.codeName organizationName, c2.name corporateName
FROM DonationPurpose d 
  left JOIN Code c1 ON d.organizationId = c1.id
  left JOIN Corporate c2 ON d.corporateId = c2.id
ORDER BY c2.id, c1.id, d.name
</select>

<select id="selectNotClosed" resultType="fund.dto.DonationPurpose">
SELECT d.*, c1.codeName organizationName, c2.name corporateName
FROM DonationPurpose d 
  left JOIN Code c1 ON d.organizationId = c1.id
  left JOIN Corporate c2 ON d.corporateId = c2.id
WHERE closed = 0  
ORDER BY c2.id, c1.id, d.name
</select>

<select id="selectById" resultType="fund.dto.DonationPurpose">
SELECT * FROM DonationPurpose WHERE id = #{id}
</select>

<insert id="insert" useGeneratedKeys="true" keyProperty="id">
INSERT DonationPurpose (corporateId, organizationId, name, gubun, closed, etc)
VALUES (#{corporateId}, #{organizationId}, #{name}, #{gubun}, 0, #{etc})
</insert>

<update id="update">
UPDATE DonationPurpose
SET corporateId = #{corporateId}, 
  organizationId = #{organizationId},
	name = #{name},
	gubun = #{gubun},
    closed = #{closed},
    etc = #{etc}
WHERE id = #{id}
</update>

<delete id="delete">
DELETE FROM [DonationPurpose] WHERE id = #{id}
</delete>

</mapper>
